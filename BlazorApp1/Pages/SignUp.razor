@page "/signup"
@using BlazorApp1.Services
@inject AuthService AuthService
@inject NavigationManager Navigation

<div class="signup-wrapper">
    <div class="signup-card card p-4 shadow-lg">
        <h3 class="text-center mb-3">Create an Account</h3>

        <input class="form-control mb-3" placeholder="Full Name" @bind="signUpModel.FullName" />
        <input class="form-control mb-3" placeholder="Email" @bind="signUpModel.Email" />
        <input class="form-control mb-3" placeholder="Username" @bind="signUpModel.Username" />
        <input class="form-control mb-3" placeholder="Password" type="password" @bind="signUpModel.Password" />
        <input class="form-control mb-3" placeholder="Role" @bind="signUpModel.Role" />

        <button class="btn btn-success w-100" @onclick="HandleSignUp">Sign Up</button>

        @if (!string.IsNullOrEmpty(message))
        {
            <div class="alert alert-info mt-3">@message</div>
        }
    </div>
</div>

<style>
    .signup-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 90vh;
        background: #f8f9fa;
    }

    .signup-card {
        width: 100%;
        max-width: 400px;
        border-radius: 15px;
    }
</style>

@code {
    private BlazorApp1.Client.Models.SignUpRequest signUpModel = new();
    private string message = "";

    private async Task HandleSignUp()
    {
        message = await AuthService.SignUpAsync(signUpModel);

        // Show message for 1.5 seconds
        StateHasChanged(); // update UI
        await Task.Delay(1500);

        // Navigate to login page if signup successful
        if (!string.IsNullOrEmpty(message) && message.ToLower().Contains("success"))
        {
            Navigation.NavigateTo("/login");
        }
    }
}
